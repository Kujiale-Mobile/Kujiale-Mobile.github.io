<!DOCTYPE html>
<html lang="zh">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.8.0">
    <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
    <script src="https://www.wenjunjiang.win/js/gitment.js"></script>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->

    

    
        <meta name="description" content="在小程序界里，生成图片分享到朋友圈这个功能，是如此得光芒耀眼，以至于各个小程序都趋之若鹜地前来跪倒在她的石榴裙下。不幸的是，微信爸爸并没有提供给我们很好很便捷的相关工具；恰恰相反，屏幕截屏的功能被残忍丢进历史的垃圾桶，只留下一个Canvas组件以及围绕在其周围的深渊巨坑们。
所以我们准备了一套名为P">
    

    <!--Author-->
    
        <meta name="author" content="酷家乐移动前端团队">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="小程序分享图片生成方案实现">
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="在小程序界里，生成图片分享到朋友圈这个功能，是如此得光芒耀眼，以至于各个小程序都趋之若鹜地前来跪倒在她的石榴裙下。不幸的是，微信爸爸并没有提供给我们很好很便捷的相关工具；恰恰相反，屏幕截屏的功能被残忍丢进历史的垃圾桶，只留下一个Canvas组件以及围绕在其周围的深渊巨坑们。
所以我们准备了一套名为P">
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="移动前端团队博客">

    <!--Type page-->
    
        <meta property="og:type" content="article">
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="http://yoursite.comhttp://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg">
    

        <meta name="twitter:card" content="summary_large_image">

    

    
        <meta name="twitter:image" content="http://yoursite.comhttp://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg">
    

    <!-- Title -->
    
    <title>小程序分享图片生成方案实现 - 移动前端团队博客</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet">

    <!-- Google Analytics -->
    


    <!-- favicon -->
    

</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">酷家乐</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/Kujiale-Mobile">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->


<header>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading" style="margin-top: 10rem">
                    <h1>
                        小程序分享图片生成方案实现
                    </h1>

                    <span style="color: #9EABB3; font-size: 1.5rem;">
                        <!-- Date and Author -->
                        
                        生忘
                         | 
                        
                        2018-07-07
                        
                    </span>
                    <span style="color: #9EABB3; font-size: 1.5rem;"> | 浏览量：<span id="busuanzi_value_page_pv"></span>次</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
            
            <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                
                


<a href="/tags/小程序/">#小程序</a> <a href="/tags/组件/">#组件</a>


                
            </div>
            <div class="col-lg-4 col-md-5 post-categories">
                
                

<a href="/categories/小程序/">小程序</a>

                
            </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p><img src="https://user-gold-cdn.xitu.io/2018/7/9/1647d4f9b1068841?w=1000&amp;h=613&amp;f=jpeg&amp;s=70128" alt=""></p>
<p>在小程序界里，生成图片分享到朋友圈这个功能，是如此得光芒耀眼，以至于各个小程序都趋之若鹜地前来跪倒在她的石榴裙下。不幸的是，微信爸爸并没有提供给我们很好很便捷的相关工具；恰恰相反，屏幕截屏的功能被残忍丢进历史的垃圾桶，只留下一个Canvas组件以及围绕在其周围的深渊巨坑们。</p>
<p>所以我们准备了一套名为Painter的工具， 为开发者提供一种简单实用的“绘制”图片的解决思路，让开发者可以自由地生成自己想要的图片文件。</p>
<p>github传送门：<a href="https://github.com/Kujiale-Mobile/Painter" target="_blank" rel="noopener">https://github.com/Kujiale-Mobile/Painter</a></p>
<p>如果直接使用canvas进行绘图，那绝对是很酸爽的一次体验，除了失控的代码，还有无数的天坑。先来列举一下canvas 中踩过的坑以及我们的解决（或绕过）的方法。</p>
<h3 id="canvas的坑"><a href="#canvas的坑" class="headerlink" title="canvas的坑"></a>canvas的坑</h3><p>painter从实现上来讲，是用了小程序的canvas作为载体来实现以上功能的。而canvas有很多著名的坑。有的坑，我们小心翼翼地绕了过去；有的坑，我们还是痛快淋漓地一脚踩了下去……</p>
<ol>
<li>在微信版本6.6.6的某些ios机型上，canvas的clip()方法不能被restore。导致在这些机型上无法进行切圆角的操作。迫于无奈在开发中我们不得已抛弃了这些机型，用了一个if语句将这些机器的切圆角功能阉割了。。。</li>
<li>小程序的canvas提供了measuretText()方法，暂时只支持测量文本宽度，无法知道文字的具体高度。因此一些元素对齐的需求无法做到很漂亮。</li>
<li>在绘制图片的时候，有几率会发生很神奇的表现，即canvas绘图的时候位置出现整体偏差，造成最后生成的图片有残缺。这种情况大多数时候发生在onLoad中调用painter的情况下。我们处理的方法是对图片的宽和高比例进行检测，一旦出现异常，就重新绘制一遍。</li>
<li>canvas不能绘制网络图片。canvas.drawImage(url)方法，给url传入一个网络链接，在模拟器上表现完美，然而在真机上无法绘制。我们在Painter中引入了一套自己的网络图片下载后绘制的机制，并在其中加入了LRU存储管理机制。</li>
<li>canvas是原生组件，始终位于视图的最上层，z-index设置对其无效。这个就不多说了。。很多人应该都踩过。</li>
<li>canvas要进行绘制，则canvas组件必须真实地被写在页面上，而且其wx:if不能为false。不过，允许把canvas组件放置在屏幕之外，如设置position:fixed;left:750rpx;。这一方法是可以解决5，6两点问题的黑科技</li>
</ol>
<h3 id="Painter的功能"><a href="#Painter的功能" class="headerlink" title="Painter的功能"></a>Painter的功能</h3><p><img src="http://sinacloud.net/music-store/markdownPic/painter1.gif?KID=sina,2o3w9tlWumQRMwg2TQqi&amp;Expires=1579069535&amp;ssig=QOPvSJJ3AH" alt=""></p>
<p>如图所示</p>
<p>通过右边的类似于css又有点像json但其实上它是个js的寥寥几行代码，我们绘制出了左边的这样的图形，包含了背景图片、文字、图片、二维码这四种常用的元素。</p>
<p>Painter阅读完代码，绘制成图片以后，会将图片的链接返回给我们。此时，我们可以将图片上传、保存到本地或者显示在屏幕上。</p>
<p>它可以很方便地定制所需要的图片，还可以自由动态地给图片更换风格。</p>
<p>此外，小程序canvas.drawImage()方法在真机上不能绘制网络图片。而Painter 可以解决这个问题，如果有绘制网络图片的需求也可以考虑使用Painter。</p>
<h3 id="Painter其它优势"><a href="#Painter其它优势" class="headerlink" title="Painter其它优势"></a>Painter其它优势</h3><ol>
<li><p>painter可以下载网络图片到本地，并对下载到本地的网络内容进行LRU管理。目前小程序允许的最大本地储存为10m，我们默认painter可使用的本地存储为6m，超出时会对本地存储进行清理。如果需要自定义，可以在/painter/lib/downloader.js中修改MAX_SPACE_IN_B属性。</p>
</li>
<li><p>目前子 view 的 css 属性支持 object 或 array。允许将几个view公用的css属性提取出来。</p>
</li>
<li>由于palette 是以 js 承载的 json，所以你可以在每一个属性中很方便的加上自己的逻辑。也可以把某些属性单独提取出来，让多个 palette 共用，做到模块化。</li>
</ol>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="demo下载"><a href="#demo下载" class="headerlink" title="demo下载"></a>demo下载</h4><p>demo项目使用submodule的方式进行管理，因此在clone时需要运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Kujiale-Mobile/Painter.git --recursive</span><br></pre></td></tr></table></figure>
<p>clone完成后可以看到目录。其中，/pages/example中存放的是使用示例，/components/painter就是我们所引入的功能组件。此外还有一个palette目录，里面存放是我们所需要绘图代码。实际工作时，painter会调取card.js里的信息，在图片上绘制出相应的图形，就像一支画笔在调色板上调制蘸取了颜料，然后在画布上创作一样。</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/painter2.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=eb8cOp%2FfLR" width="200"></p>
<h4 id="将Painter引入到自己的项目"><a href="#将Painter引入到自己的项目" class="headerlink" title="将Painter引入到自己的项目"></a>将Painter引入到自己的项目</h4><p>你可以直接将demo里的painter复制粘贴到自己的项目下，当然也可以更为优雅地运行一下这个代码：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule add https://github.com/Kujiale-Mobile/PainterCore.git painter</span><br></pre></td></tr></table></figure>
<p>它会将Painter工具放置在你当前的目录下。我们推荐的做法是把它放在你的components下。</p>
<h4 id="引入组件"><a href="#引入组件" class="headerlink" title="引入组件"></a>引入组件</h4><p>像其它的组件一样，在需要引入Painter的页面.json文件中添加：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"usingComponents":&#123;</span><br><span class="line">  "painter":"/components/painter/painter"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="组件调用"><a href="#组件调用" class="headerlink" title="组件调用"></a>组件调用</h4><p>在页面的xml文件中调用painter组件，并传入pallete规则的数据，以及绘制结束以后的回调。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">painter</span> <span class="attr">palette</span>=<span class="string">"&#123;&#123;data&#125;&#125;"</span> <span class="attr">bind:imgOK</span>=<span class="string">"onImgOK"</span> <span class="attr">bind:imgErr</span>=<span class="string">"onImgErr"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>palette即是我们的调色板数据，以json形式根据一定规范创建，详细信息请移步下文。</p>
<h4 id="绘制回调"><a href="#绘制回调" class="headerlink" title="绘制回调"></a>绘制回调</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bind:imgOK=<span class="string">"onImgOK"</span></span><br><span class="line">bind:imgErr=<span class="string">"onImgErr"</span></span><br></pre></td></tr></table></figure>
<p>数据传入后，painter就会开始绘制，无论绘制成功或是失败，都能在相应的回调方法里获取相关的信息，如：</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/painter3.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=pqFHDi2C07" width="300">              <img src="http://sinacloud.net/music-store/markdownPic/painter4.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=vIjymNrLl0" width="300"></p>
<h3 id="Pallette"><a href="#Pallette" class="headerlink" title="Pallette"></a>Pallette</h3><p>说到底，Painter是一支画笔工具，具体要让这支画笔画什么东西，还得由我们，天资聪颖的程序猿们，来告诉它。告诉它应该画什么，在哪里画，画的时候用什么姿势……等等。这需要用一些别的手段，因为科学的实验证明过，试图用普通话这门语言跟它进行沟通，是不会有任何效果的。</p>
<h4 id="调色板属性"><a href="#调色板属性" class="headerlink" title="调色板属性"></a>调色板属性</h4><p>每一块调色板都它自己的整体属性，它一般规定了整个绘图范围的大小、样式、背景等</p>
<p>它处于整个json文件的最外层，需要指定以下几个属性：</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">background</td>
<td>背景，可以是颜色值，也可以是图片链接，支持本地图片链接和网络图片链接</td>
</tr>
<tr>
<td style="text-align:left">width</td>
<td>宽度</td>
</tr>
<tr>
<td style="text-align:left">height</td>
<td>高度</td>
</tr>
<tr>
<td style="text-align:left">borderRadius</td>
<td>圆角</td>
</tr>
<tr>
<td style="text-align:left">views</td>
<td>需要画在图上的其它元素，允许为空，但不允许省略</td>
</tr>
</tbody>
</table>
<p>示例代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">      background: &apos;https://qhyxpicoss.kujiale.com/2018/06/12/LMPUSDAKAEBKKOASAAAAAAY8_981x600.png&apos;,</span><br><span class="line">      width: &apos;654rpx&apos;,</span><br><span class="line">      height: &apos;400rpx&apos;,</span><br><span class="line">      borderRadius: &apos;20rpx&apos;,</span><br><span class="line">      views: []</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h4 id="view属性"><a href="#view属性" class="headerlink" title="view属性"></a>view属性</h4><p>画完了调色板的整体属性以后，就可以向views中增加一些元素了。元素支持四种类型，用type字段进行区分分类。不同种类的view又要求提供有不同的数据，如image元素需要提供它的url，text元素需要提供text文字内容：</p>
<table>
<thead>
<tr>
<th>type</th>
<th>content</th>
<th>description</th>
<th>私有css属性</th>
</tr>
</thead>
<tbody>
<tr>
<td>image</td>
<td>url</td>
<td>图片资源地址，本地或网络</td>
<td></td>
</tr>
<tr>
<td>text</td>
<td>text</td>
<td>文本元素，书写文字</td>
<td>fontSize:字体大小，color:文字颜色</td>
</tr>
<tr>
<td>rect</td>
<td>无</td>
<td>矩形</td>
<td>color:填充颜色</td>
</tr>
<tr>
<td>qrcode</td>
<td>content</td>
<td>画二维码</td>
<td>background:背景颜色，默认为透明</td>
</tr>
</tbody>
</table>
<p>除了各view的私有属性之外，view还有一些公共属性可以设置：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>left, top, right, bottom</td>
<td>元素的位置</td>
</tr>
<tr>
<td>rotate</td>
<td>旋转角度，单位为360度的度</td>
</tr>
<tr>
<td>borderRadius</td>
<td>圆角，如果需要设置图片为原形，请设置该属性为宽或高的一半</td>
</tr>
<tr>
<td>align</td>
<td>元素在水平方向的对齐方式，与left配合使用，可设置为left, center, right，默认为left。</td>
</tr>
</tbody>
</table>
<h5 id="rotate"><a href="#rotate" class="headerlink" title="rotate"></a>rotate</h5><p>控制元素的旋转，如下图，将一行文字顺时针旋转了6度。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    type: 'text',</span><br><span class="line">    text: '酷家乐 移动前端',</span><br><span class="line">    css: &#123;</span><br><span class="line">     left: '20rpx',</span><br><span class="line">     top: '50rpx',</span><br><span class="line">     fontSize: '40rpx'</span><br><span class="line">   &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>效果：</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/painter5.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=%2FIQFDrXwM8" width="300"></p>
<h5 id="borderRadius"><a href="#borderRadius" class="headerlink" title="borderRadius"></a>borderRadius</h5><p>代码(圆形)：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  type: <span class="string">'image'</span>,</span><br><span class="line">  url: <span class="keyword">this</span>.cardInfo.avatar,</span><br><span class="line">  css: &#123;</span><br><span class="line">    top: <span class="string">'48rpx'</span>,</span><br><span class="line">    left: <span class="string">'448rpx'</span>,</span><br><span class="line">    width: <span class="string">'192rpx'</span>,</span><br><span class="line">    height: <span class="string">'192rpx'</span>,</span><br><span class="line">    borderRadius:<span class="string">'96rpx'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>方角–&gt;8rpx圆角–&gt;圆形</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/painter6.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=mRPxmGLq%2FM" width="300"></p>
<h5 id="align"><a href="#align" class="headerlink" title="align"></a>align</h5><p>这个属性值比较有意思，它被用来设置元素在水平方向的、相对于位置设置的对齐方式。</p>
<p>什么意思呢？</p>
<p>比如说你设置了某元素的left为100rpx，并设置align属性为left，那么该元素的左端就与100rpx对齐；若设置align为center，则该元素的中轴线与100rpx对齐。</p>
<p>在下面的例子中，三行文字的left都是230rpx，align分别为left, center, right。红线是横坐标为230rpx的轴线。</p>
<p>即，当设置了align属性的时候，left值表达的是元素属性中align的位置。</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/painter7.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=NKWF9HpTSU" width="300"></p>
<p>代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        type: <span class="string">'text'</span>,</span><br><span class="line">        text: <span class="string">'酷家乐 移动前端'</span>,</span><br><span class="line">        css: &#123;</span><br><span class="line">          left: <span class="string">'330rpx'</span>,</span><br><span class="line">          top: <span class="string">'100rpx'</span>,</span><br><span class="line">          fontSize: <span class="string">'40rpx'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">'text'</span>,</span><br><span class="line">        text: <span class="string">'酷家乐 移动前端'</span>,</span><br><span class="line">        css: &#123;</span><br><span class="line">          left: <span class="string">'330rpx'</span>,</span><br><span class="line">          top: <span class="string">'200rpx'</span>,</span><br><span class="line">          fontSize: <span class="string">'40rpx'</span>,</span><br><span class="line">          align: <span class="string">'center'</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        type: <span class="string">'text'</span>,</span><br><span class="line">        text: <span class="string">'酷家乐 移动前端'</span>,</span><br><span class="line">        css: &#123;</span><br><span class="line">          left: <span class="string">'330rpx'</span>,</span><br><span class="line">          top: <span class="string">'300rpx'</span>,</span><br><span class="line">          fontSize: <span class="string">'40rpx'</span>,</span><br><span class="line">          align: <span class="string">'right'</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>
<p>有了这个属性，就可以设置元素的对齐形式，完成下面的布局要求了：</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/painter8.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=n9f0Zi2sd5" width="300">          <img src="http://sinacloud.net/music-store/markdownPic/painter9.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=We9qnzenXa" width="300"></p>
<p><strong>注意：align属性请和left属性配合使用，设置right值将造成错误。</strong></p>
<h5 id="align与rotate"><a href="#align与rotate" class="headerlink" title="align与rotate"></a>align与rotate</h5><p>当align属性与rotate属性同时存在时，元素的旋转表现是以元素的中心点为中心的。</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/painter10.png?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1579069535&ssig=smbGVG%2F3u3" width="300"></p>
<h4 id="尺寸单位"><a href="#尺寸单位" class="headerlink" title="尺寸单位"></a>尺寸单位</h4><p>目前 Painter 中支持两种尺寸单位，px 和 rpx，代表的意思和小程序中一致。目前还没有很好地支持百分比的使用。</p>
<h4 id="保存图片演示"><a href="#保存图片演示" class="headerlink" title="保存图片演示"></a>保存图片演示</h4><p>获得图片的url后，可以设置一个点击按钮，点击保存到本地</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">onImgOK(e) &#123;</span><br><span class="line">  this.imagePath = e.detail.path;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">saveImage() &#123;</span><br><span class="line">  wx.saveImageToPhotosAlbum(&#123;</span><br><span class="line">    filePath: this.imagePath,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>按钮绑定saveImage方法，点击进行保存：</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/painter12.gif?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1599707408&ssig=4CxJKcKxV8" width="500"></p>
<h3 id="生成朋友圈分享图"><a href="#生成朋友圈分享图" class="headerlink" title="生成朋友圈分享图"></a>生成朋友圈分享图</h3><p>最后，利用Painter工具可以生成不同样式的朋友圈分享图(下图为微信小程序 酷咖名片 线上版部分截图)</p>
<p><img src="http://sinacloud.net/music-store/markdownPic/share1.jpeg?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1599707408&ssig=HgqWb35Pbh" width="230">                                     <img src="http://sinacloud.net/music-store/markdownPic/share2.jpeg?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1599707408&ssig=XwFCwR67iz" width="230">  </p>
<p><img src="http://sinacloud.net/music-store/markdownPic/share3.jpeg?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1599707408&ssig=eUX6XhYCBg" width="230">                     <img src="http://sinacloud.net/music-store/markdownPic/share4.jpeg?KID=sina,2o3w9tlWumQRMwg2TQqi&Expires=1599707408&ssig=ZQRv4QwSOU" width="230"></p>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>painter是酷家乐前端在小程序的实际开发中自制的一套工具，目前在朋友圈分享、皮肤模板替换等方面都在使用，觉得用起来喜忧参半。开源出来大家分享。如果它能帮助到任何一个人，我们都非常开心；我们也非常欢迎并感谢提issure或pr，来告诉我们一些我们自己没有能想到的东西，或者帮助解决Painter 中的大大小小的坑：</p>
<p>再一次传送门地址：<a href="https://github.com/Kujiale-Mobile/Painter" target="_blank" rel="noopener">https://github.com/Kujiale-Mobile/Painter</a></p>


                
            </div>

            <!-- Comments -->
            
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h3>评论</h3>
<div id="comments">
</div>
<script>
    const gitment = new Gitment({
        owner: 'CPPAlien',
        repo: 'Gitment',
        oauth: {
            client_id: '3796c932b6130b5f8a5e',
            client_secret: '708e5b019d02a6a6e425189044ae945ed45815bb',
        },
    })

    gitment.render('comments')
</script>
            </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr>

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/Kujiale-Mobile" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2018 酷家乐移动前端团队<br></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>